<!--
title: 단체선물대장 기획 와이어프레임
meta: 기획용 프로토타입 | 내부관리자 / 고객사 / 매입처 3역할 | 2026.02.17
-->
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&display=swap');
.gp *{margin:0;padding:0;box-sizing:border-box}
.gp{font-family:'Noto Sans KR',sans-serif;font-size:12px;color:#1a2332;background:#fff;display:flex;flex-direction:column;height:calc(100vh - 40px);overflow:hidden;line-height:1.5;position:relative}
.gp-role{display:flex;border-bottom:2px solid #e2e8f0;flex-shrink:0;background:#f8fafd;padding:0 16px}
.gp-role__btn{padding:8px 16px;border:none;background:none;color:#94a3b8;font-size:12px;font-weight:700;cursor:pointer;border-bottom:3px solid transparent;margin-bottom:-2px;font-family:'Noto Sans KR',sans-serif;transition:all .12s;white-space:nowrap}
.gp-role__btn:hover{color:#4a5568}
.gp-role__btn.r-a.active{color:#4a90d9;border-bottom-color:#4a90d9}
.gp-role__btn.r-c.active{color:#059669;border-bottom-color:#059669}
.gp-role__btn.r-s.active{color:#ea580c;border-bottom-color:#ea580c}
.gp-rb{display:inline-block;padding:1px 6px;border-radius:8px;font-size:9px;font-weight:700;margin-left:4px;vertical-align:middle}
.rb-a{background:#eef4fb;color:#4a90d9}.rb-c{background:#ecfdf5;color:#059669}.rb-s{background:#fff7ed;color:#ea580c}
.gp-tabs{display:flex;border-bottom:1px solid #e2e8f0;flex-shrink:0;background:#fff;padding:0 16px}
.gp-tab{padding:7px 14px;border:none;background:none;color:#94a3b8;font-size:11px;font-weight:600;cursor:pointer;border-bottom:2px solid transparent;font-family:'Noto Sans KR',sans-serif;transition:all .12s;white-space:nowrap}
.gp-tab:hover{color:#4a5568}.gp-tab.active{color:#4a90d9;border-bottom-color:#4a90d9}
.gp-main{flex:1;overflow:hidden;display:flex;flex-direction:column;min-height:0}
.gp-rp,.gp-pn{display:none;flex:1;overflow:hidden;flex-direction:column;min-height:0}
.gp-rp.active,.gp-pn.active{display:flex}
.gp-sp{display:flex;flex:1;gap:0;min-height:0;overflow:hidden}
.gp-l{width:380px;min-width:300px;border-right:1px solid #e2e8f0;display:flex;flex-direction:column;overflow:hidden;flex-shrink:0}
.gp-r{flex:1;display:flex;flex-direction:column;overflow:hidden;min-width:0}
.gp-cds{display:flex;gap:6px;padding:10px 16px 6px;flex-shrink:0;flex-wrap:wrap}
.gp-cd{background:#f8fafd;border:1px solid #e2e8f0;border-radius:4px;padding:7px 10px;min-width:90px;flex:1}
.gp-cd i{font-style:normal;font-size:9px;color:#94a3b8;font-weight:600;letter-spacing:.3px;text-transform:uppercase;display:block;margin-bottom:1px}
.gp-cd b{font-size:14px;font-weight:800;font-family:'JetBrains Mono',monospace;font-variant-numeric:tabular-nums;display:block}
.gp-ph{display:flex;align-items:center;justify-content:space-between;padding:6px 10px;background:#f8fafd;border-bottom:1px solid #e2e8f0;flex-shrink:0;gap:4px;min-height:34px}
.gp-ph span{font-size:11px;font-weight:700;color:#4a5568;white-space:nowrap}
.gp-sb{flex:1;overflow-y:auto;min-height:0}.gp-sb::-webkit-scrollbar{width:5px}.gp-sb::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}
.gp table{width:100%;border-collapse:collapse;font-size:11px}
.gp thead{position:sticky;top:0;z-index:2}
.gp th{background:#f0f4f9;color:#4a5568;font-weight:600;font-size:10px;padding:5px 8px;text-align:left;border-bottom:2px solid #e2e8f0;white-space:nowrap}
.gp td{padding:4px 8px;border-bottom:1px solid #f1f5f9;white-space:nowrap;color:#4a5568}
.gp tr:hover{background:#f8fafd}.gp tr.s{background:#eef4fb}.gp tr.ck{cursor:pointer}
.gp .r{text-align:right;font-family:'JetBrains Mono',monospace;font-variant-numeric:tabular-nums}
.gp .c{text-align:center}.gp .f{font-weight:700;color:#1a2332}.gp .d{color:#94a3b8;font-size:10px}
.gp .m{font-family:'JetBrains Mono',monospace}
.gp-inp{padding:4px 8px;border:1px solid #cbd5e1;border-radius:3px;font-size:11px;font-family:'Noto Sans KR',sans-serif;color:#1a2332;background:#fff;outline:none}
.gp-inp:focus{border-color:#4a90d9;box-shadow:0 0 0 2px rgba(74,144,217,.12)}
.gp-sel{padding:4px 6px;border:1px solid #cbd5e1;border-radius:3px;font-size:11px;background:#fff;outline:none}
.gp-btn{padding:4px 10px;border:1px solid #cbd5e1;border-radius:3px;background:#fff;color:#4a5568;font-size:11px;cursor:pointer;font-family:'Noto Sans KR',sans-serif;transition:all .12s;white-space:nowrap}
.gp-btn:hover{background:#eef4fb;color:#4a90d9;border-color:#4a90d9}
.gp-btn.p{background:#4a90d9;color:#fff;border-color:#4a90d9}.gp-btn.p:hover{background:#3a7bc8}
.gp-btn.sm{padding:2px 8px;font-size:10px}
.gp-btn.dg{background:#e85d5d;color:#fff;border-color:#e85d5d}
.gp-bg{display:inline-block;padding:2px 8px;border-radius:10px;font-size:10px;font-weight:600}
.bg-dr{background:#f1f5f9;color:#6b7280}.bg-co{background:#eef4fb;color:#2563eb}.bg-cl{background:#fef9ee;color:#d49a2a}.bg-or{background:#dbeafe;color:#3b82f6}.bg-sh{background:#d1fae5;color:#059669}.bg-dn{background:#ecfdf5;color:#22c55e}.bg-pd{background:#fff7ed;color:#ea580c}.bg-ap{background:#ecfdf5;color:#22c55e}.bg-rj{background:#fef2f2;color:#e85d5d}
.gp-pp{display:flex;gap:2px;padding:8px 16px;align-items:center;flex-shrink:0;border-bottom:1px solid #e2e8f0;background:#f8fafd}
.gp-pp div{flex:1;text-align:center;padding:5px 4px;border-radius:3px;font-size:10px;font-weight:700}
.gp-pp i{font-style:normal;color:#d1d5db;font-size:9px;flex-shrink:0}
.gp-dg{display:grid;grid-template-columns:repeat(3,1fr);gap:4px;margin-bottom:8px}
.gp-di{background:#f8fafd;border:1px solid #e2e8f0;border-radius:4px;padding:6px 8px}
.gp-di i{font-style:normal;font-size:9px;color:#94a3b8;font-weight:600;text-transform:uppercase;display:block}
.gp-di b{font-size:13px;font-weight:700;font-family:'JetBrains Mono',monospace;display:block;margin-top:1px}
.gp-ds{font-size:11px;font-weight:700;color:#4a5568;margin:10px 0 4px;padding-bottom:2px;border-bottom:1px solid #e2e8f0}
.gp-pr{width:100%;height:6px;background:#e2e8f0;border-radius:3px;overflow:hidden}.gp-pr div{height:100%;border-radius:3px}
.gp-fb{display:flex;gap:6px;padding:6px 10px;flex-shrink:0;align-items:center;flex-wrap:wrap;border-bottom:1px solid #e2e8f0}
.gp-st{display:flex;gap:0;border-bottom:1px solid #e2e8f0;flex-shrink:0;padding:0 10px}
.gp-st div{padding:5px 12px;font-size:11px;color:#94a3b8;cursor:pointer;border-bottom:2px solid transparent;font-weight:500}
.gp-st div:hover{color:#4a5568}.gp-st div.a{color:#4a90d9;border-bottom-color:#4a90d9;font-weight:600}
.gp-fm{padding:8px 10px;border:1px solid #e2e8f0;border-radius:4px;background:#f8fafd;margin:6px 0}
.gp-fg{display:flex;flex-direction:column;gap:2px;margin-bottom:6px}
.gp-fg label{font-size:10px;color:#94a3b8;font-weight:500}
.gp-fg input,.gp-fg select,.gp-fg textarea{height:28px;border:1px solid #cbd5e1;border-radius:3px;font-size:11px;padding:0 6px;font-family:'Noto Sans KR',sans-serif;outline:none}
.gp-fg textarea{height:50px;padding:4px 6px;resize:vertical}
.gp-pc{display:flex;gap:8px;padding:6px 8px;border:1px solid #e2e8f0;border-radius:4px;margin-bottom:4px;align-items:center;cursor:pointer;transition:all .1s}
.gp-pc:hover{border-color:#4a90d9;background:#fafcff}.gp-pc.s{border-color:#4a90d9;background:#eef4fb}
.gp-pc div:first-child{width:44px;height:44px;background:#f0f4f9;border-radius:3px;display:flex;align-items:center;justify-content:center;font-size:8px;color:#94a3b8;flex-shrink:0}
.gp-tk{border:1px solid #e2e8f0;border-radius:4px;padding:8px 10px;background:#f8fafd;margin:0 16px 8px;flex-shrink:0}
.gp-ft{padding:5px 10px;background:#f8fafd;border-top:1px solid #e2e8f0;font-size:10px;color:#94a3b8;display:flex;justify-content:space-between;align-items:center;flex-shrink:0}
.gp-em{color:#94a3b8;text-align:center;padding:40px 16px;font-size:12px}
.gp-w{background:#fef2f2!important}
@media(max-width:900px){.gp-sp{flex-direction:column}.gp-l{width:100%!important;min-width:0!important;border-right:none;border-bottom:1px solid #e2e8f0;max-height:40%}}
</style>

<div class="gp" id="gpRoot">
<div class="gp-role">
<button class="gp-role__btn r-a active" onclick="gpRole('a',this)">내부 관리자 <span class="gp-rb rb-a">Admin</span></button>
<button class="gp-role__btn r-c" onclick="gpRole('c',this)">고객사 담당자 <span class="gp-rb rb-c">Client</span></button>
<button class="gp-role__btn r-s" onclick="gpRole('s',this)">매입처 담당자 <span class="gp-rb rb-s">Supplier</span></button>
</div>
<div class="gp-main">
<div class="gp-rp active" id="gp-a"><div class="gp-tabs" id="gt-a"><button class="gp-tab active" onclick="gpS('a','ap',this)">상품 등록/관리</button><button class="gp-tab" onclick="gpS('a','ai',this)">문의/승인 관리</button><button class="gp-tab" onclick="gpS('a','at',this)">전체 주문현황</button></div><div class="gp-pn active" id="ap"></div><div class="gp-pn" id="ai"></div><div class="gp-pn" id="at"></div></div>
<div class="gp-rp" id="gp-c"><div class="gp-tabs" id="gt-c"><button class="gp-tab active" onclick="gpS('c','cc',this)">상품 카탈로그/요청서</button><button class="gp-tab" onclick="gpS('c','cp',this)">제안서 생성</button><button class="gp-tab" onclick="gpS('c','co',this)">견적/사용자등록/선택</button></div><div class="gp-pn active" id="cc"></div><div class="gp-pn" id="cp"></div><div class="gp-pn" id="co"></div></div>
<div class="gp-rp" id="gp-s"><div class="gp-tabs" id="gt-s"><button class="gp-tab active" onclick="gpS('s','so',this)">상품별 주문현황</button><button class="gp-tab" onclick="gpS('s','st',this)">주문정보/송장입력</button></div><div class="gp-pn active" id="so"></div><div class="gp-pn" id="st"></div></div>
</div>
</div>

<script>
var CATS=[{n:'식품'},{n:'생활'},{n:'뷰티'},{n:'가전'},{n:'패션'}];
var PR=[{i:1,c:'P001',n:'한우 선물세트 1호',ct:'식품',p:45000,s:38000,sp:'(주)한우농장',a:1},{i:2,c:'P002',n:'프리미엄 견과세트',ct:'식품',p:39000,s:32000,sp:'(주)견과나라',a:1},{i:3,c:'P003',n:'올리브유 세트',ct:'식품',p:42000,s:35000,sp:'올리브트레이드',a:1},{i:4,c:'P004',n:'프리미엄 샴푸세트',ct:'뷰티',p:35000,s:28000,sp:'뷰티월드',a:1},{i:5,c:'P005',n:'텀블러 세트',ct:'생활',p:25000,s:18000,sp:'리빙플러스',a:1},{i:6,c:'P006',n:'한우 선물세트 2호',ct:'식품',p:65000,s:55000,sp:'(주)한우농장',a:1},{i:7,c:'P007',n:'과일 바구니 세트',ct:'식품',p:55000,s:45000,sp:'과일마을',a:1},{i:8,c:'P008',n:'블루투스 스피커',ct:'가전',p:48000,s:38000,sp:'테크기프트',a:1},{i:9,c:'P009',n:'고급 수건세트',ct:'생활',p:30000,s:22000,sp:'리빙플러스',a:0},{i:10,c:'P010',n:'유기농 꿀 세트',ct:'식품',p:38000,s:30000,sp:'(주)견과나라',a:1},{i:11,c:'P011',n:'핸드크림 세트',ct:'뷰티',p:28000,s:20000,sp:'뷰티월드',a:1},{i:12,c:'P012',n:'무선충전 패드',ct:'가전',p:32000,s:24000,sp:'테크기프트',a:1}];
var IQ=[{i:1,co:'삼성전자',ct:'김부장',ph:'010-1234-5678',bg:'3~5만원',q:200,ca:'식품',mm:'설선물, 친환경포장',d:'02-10',st:'PENDING'},{i:2,co:'LG에너지솔루션',ct:'박과장',ph:'010-2345-6789',bg:'4~6만원',q:80,ca:'식품,가전',mm:'VIP 별도',d:'02-12',st:'APPROVED'},{i:3,co:'현대자동차',ct:'이대리',ph:'010-3456-7890',bg:'2~3만원',q:500,ca:'생활',mm:'근로자의날',d:'02-14',st:'PENDING'},{i:4,co:'SK하이닉스',ct:'최팀장',ph:'010-4567-8901',bg:'5만원+',q:150,ca:'식품,뷰티',mm:'',d:'02-08',st:'REJECTED'},{i:5,co:'네이버',ct:'정매니저',ph:'010-5678-9012',bg:'3~4만원',q:120,ca:'',mm:'제안서 먼저',d:'02-15',st:'PENDING'}];
var TP=[{i:1,n:'2026 설',co:'삼성전자',st:'COLLECTING',sh:'01.28',pr:[1,2,3],rc:35,oc:30},{i:2,n:'2026 설',co:'LG에너지솔루션',st:'CLOSED',sh:'01.25',pr:[1,6],rc:12,oc:12},{i:3,n:'근로자의날',co:'현대자동차',st:'DRAFT',sh:'05.01',pr:[],rc:0,oc:0},{i:4,n:'2026 설',co:'SK하이닉스',st:'ORDERED',sh:'01.27',pr:[2,5],rc:18,oc:16},{i:5,n:'2025 추석',co:'삼성전자',st:'COMPLETE',sh:'09.15',pr:[7],rc:15,oc:15},{i:6,n:'2026 설',co:'네이버',st:'SHIPPING',sh:'01.29',pr:[1,8],rc:20,oc:18}];
var SU=[{id:'S001',n:'(주)한우농장',p:[1,6]},{id:'S002',n:'(주)견과나라',p:[2,10]},{id:'S003',n:'올리브트레이드',p:[3]},{id:'S004',n:'뷰티월드',p:[4,11]},{id:'S005',n:'리빙플러스',p:[5,9]},{id:'S006',n:'과일마을',p:[7]},{id:'S007',n:'테크기프트',p:[8,12]}];
var RC=[],OD=[];
(function(){var fn=['김','이','박','최','정','강','조','윤'],ln=['철수','영희','지민','수진','민수','하늘','서연','준호','예린','태현'];var ad=['서울 강남구','서울 서초구','경기 수원시','부산 해운대구','대전 유성구','인천 연수구'];var ri=1,oi=1;TP.forEach(function(t){if(!t.rc)return;for(var j=0;j<t.rc;j++){var nm=fn[~~(Math.random()*fn.length)]+ln[~~(Math.random()*ln.length)];var r={x:ri++,t:t.i,nm:nm,ph:'010-'+String(1e3+~~(Math.random()*9e3))+'-'+String(1e3+~~(Math.random()*9e3)),ad:ad[~~(Math.random()*ad.length)]+' '+~~(Math.random()*200+1),tp:Math.random()>.3?'알림톡':'수기'};RC.push(r);if(j<t.oc&&t.pr.length){var pi=t.pr[~~(Math.random()*t.pr.length)];var ss=t.st==='COMPLETE'?['DELIVERED']:t.st==='SHIPPING'?['SHIPPING','DELIVERED']:t.st==='ORDERED'?['ORDERED','SHIPPING']:['ORDERED'];var s=ss[~~(Math.random()*ss.length)];OD.push({x:oi++,r:r.x,t:t.i,p:pi,q:1,s:s,rn:Math.random()>.7?(fn[~~(Math.random()*fn.length)]+ln[~~(Math.random()*ln.length)]):nm,tk:s==='SHIPPING'||s==='DELIVERED'?'CJ'+String(1e8+~~(Math.random()*9e8)):''});}}})})();

var G={r:'a',s:{a:'ap',c:'cc',s:'so'},ps:null,is:null,ts:null,pp:{},cs:'recv',si:'S001'};
function _N(v){v=+v||0;if(!v)return'0';return(v<0?'-':'')+Math.abs(v).toLocaleString()}
function _S(v){v=+v||0;var p=v<0?'-':'',a=Math.abs(v);if(a>=1e8)return p+(a/1e8).toFixed(1)+'억';if(a>=1e4)return p+Math.round(a/1e4)+'만';return p+a.toLocaleString()}
function E(id){return document.getElementById(id)}
function _P(i){return PR.find(function(p){return p.i===i})||{n:'?',p:0,s:0,c:'?',ct:'?',sp:'?'}}
function _B(s){var m={DRAFT:'bg-dr',COLLECTING:'bg-co',CLOSED:'bg-cl',ORDERED:'bg-or',SHIPPING:'bg-sh',COMPLETE:'bg-dn',DELIVERED:'bg-dn',PENDING:'bg-pd',APPROVED:'bg-ap',REJECTED:'bg-rj'},l={DRAFT:'초안',COLLECTING:'수집중',CLOSED:'마감',ORDERED:'발주',SHIPPING:'배송중',COMPLETE:'완료',DELIVERED:'배송완료',PENDING:'대기',APPROVED:'승인',REJECTED:'반려'};return'<span class="gp-bg '+(m[s]||'bg-dr')+'">'+(l[s]||s)+'</span>'}

function gpRole(r,el){G.r=r;document.querySelectorAll('.gp-role__btn').forEach(function(b){b.classList.remove('active')});el.classList.add('active');document.querySelectorAll('.gp-rp').forEach(function(p){p.classList.remove('active')});E('gp-'+r).classList.add('active');_R()}
function gpS(r,s,el){G.s[r]=s;E('gt-'+r).querySelectorAll('.gp-tab').forEach(function(t){t.classList.remove('active')});el.classList.add('active');E('gp-'+r).querySelectorAll('.gp-pn').forEach(function(p){p.classList.remove('active')});E(s).classList.add('active');_R()}
function _R(){var m={a:{ap:rAP,ai:rAI,at:rAT},c:{cc:rCC,cp:rCP,co:rCO},s:{so:rSO,st:rST}};m[G.r][G.s[G.r]]()}

/* ═══ ADMIN: 상품 등록/관리 ═══ */
function rAP(){
  var q=(E('_pq')?E('_pq').value:'').toLowerCase(),ct=E('_pc')?E('_pc').value:'',ac=E('_pa')?E('_pa').value:'';
  var fl=PR.filter(function(p){if(q&&(p.n+' '+p.c).toLowerCase().indexOf(q)===-1)return false;if(ct&&p.ct!==ct)return false;if(ac==='Y'&&!p.a)return false;if(ac==='N'&&p.a)return false;return true});
  var h='<div class="gp-sp"><div class="gp-l"><div class="gp-ph"><span>상품 목록 ('+fl.length+')</span><div style="display:flex;gap:4px"><button class="gp-btn sm p" onclick="alert(\'등록\')">+ 신규 등록</button></div></div><div class="gp-fb" style="padding:4px 8px"><input class="gp-inp" placeholder="상품명, 코드..." style="flex:1" id="_pq" oninput="rAP()" value="'+q.replace(/"/g,'&quot;')+'"><select class="gp-sel" id="_pc" onchange="rAP()"><option value="">전체</option>';
  CATS.forEach(function(c){h+='<option'+(ct===c.n?' selected':'')+'>'+c.n+'</option>'});
  h+='</select><select class="gp-sel" id="_pa" onchange="rAP()"><option value="">전체</option><option value="Y"'+(ac==='Y'?' selected':'')+'>활성</option><option value="N"'+(ac==='N'?' selected':'')+'>비활성</option></select></div><div class="gp-sb"><table><thead><tr><th style="width:50px">코드</th><th>상품명</th><th>카테고리</th><th class="r">판매가</th><th class="r">매입가</th><th class="c">상태</th></tr></thead><tbody>';
  fl.forEach(function(p){h+='<tr class="ck'+(G.ps===p.i?' s':'')+'" onclick="G.ps='+p.i+';rAP()"><td class="m d" style="font-size:9px">'+p.c+'</td><td class="f">'+p.n+'</td><td class="d">'+p.ct+'</td><td class="r m" style="font-weight:600">'+_N(p.p)+'</td><td class="r m" style="font-weight:600;color:#ea580c">'+_N(p.s)+'</td><td class="c">'+(p.a?'<span style="color:#22c55e;font-weight:700">ON</span>':'<span class="d">OFF</span>')+'</td></tr>'});
  h+='</tbody></table></div><div class="gp-ft"><span>'+fl.length+'개</span></div></div>';
  h+='<div class="gp-r"><div class="gp-ph"><span>상품 상세</span><div style="display:flex;gap:4px"><button class="gp-btn sm">수정</button><button class="gp-btn sm dg">삭제</button></div></div><div class="gp-sb" style="padding:10px">';
  if(!G.ps)h+='<div class="gp-em">좌측에서 상품을 선택하세요</div>';
  else{var p=_P(G.ps);h+='<div class="gp-dg"><div class="gp-di"><i>상품코드</i><b style="font-size:12px">'+p.c+'</b></div><div class="gp-di"><i>카테고리</i><b style="font-size:12px;font-family:Noto Sans KR,sans-serif">'+p.ct+'</b></div><div class="gp-di"><i>상태</i><b>'+(p.a?'<span style="color:#22c55e">활성</span>':'<span style="color:#e85d5d">비활성</span>')+'</b></div></div><div class="gp-dg"><div class="gp-di"><i>판매가</i><b style="color:#4a90d9">'+_N(p.p)+'</b></div><div class="gp-di"><i>매입가</i><b style="color:#ea580c">'+_N(p.s)+'</b></div><div class="gp-di"><i>마진율</i><b style="color:#22c55e">'+((p.p-p.s)/p.p*100).toFixed(1)+'%</b></div></div>';
  h+='<div class="gp-ds">기본 정보</div><div style="display:grid;grid-template-columns:80px 1fr;gap:4px 8px;font-size:11px"><span class="d">상품명</span><span class="f">'+p.n+'</span><span class="d">매입처</span><span>'+p.sp+'</span><span class="d">이미지</span><span class="d">(이미지 영역)</span></div>';
  h+='<div class="gp-ds">사용 중인 캠페인</div>';var used=TP.filter(function(t){return t.pr.indexOf(p.i)!==-1});if(!used.length)h+='<div class="d" style="padding:6px 0">없음</div>';else{h+='<table><thead><tr><th>캠페인</th><th>고객사</th><th class="c">상태</th></tr></thead><tbody>';used.forEach(function(t){h+='<tr><td>'+t.n+'</td><td>'+t.co+'</td><td class="c">'+_B(t.st)+'</td></tr>'});h+='</tbody></table>';}}
  h+='</div></div></div>';E('ap').innerHTML=h;
}

/* ═══ ADMIN: 문의/승인 관리 ═══ */
function rAI(){
  var pc={PENDING:0,APPROVED:0,REJECTED:0};IQ.forEach(function(q){pc[q.st]++});
  var sf=E('_if')?E('_if').value:'';
  var fl=sf?IQ.filter(function(q){return q.st===sf}):IQ;
  var h='<div class="gp-cds">';[{l:'전체',v:IQ.length},{l:'대기',v:pc.PENDING,c:'#ea580c'},{l:'승인',v:pc.APPROVED,c:'#22c55e'},{l:'반려',v:pc.REJECTED,c:'#e85d5d'}].forEach(function(x){h+='<div class="gp-cd"><i>'+x.l+'</i><b'+(x.c?' style="color:'+x.c+'"':'')+'>'+x.v+'건</b></div>'});h+='</div>';
  h+='<div class="gp-sp"><div class="gp-l"><div class="gp-ph"><span>문의 목록</span><select class="gp-sel" id="_if" onchange="rAI()"><option value="">전체</option><option value="PENDING"'+(sf==='PENDING'?' selected':'')+'>대기</option><option value="APPROVED"'+(sf==='APPROVED'?' selected':'')+'>승인</option><option value="REJECTED"'+(sf==='REJECTED'?' selected':'')+'>반려</option></select></div><div class="gp-sb"><table><tbody>';
  fl.forEach(function(q){h+='<tr class="ck'+(q.st==='PENDING'?' gp-w':'')+(G.is===q.i?' s':'')+'" onclick="G.is='+q.i+';rAI()"><td style="padding:6px 10px"><div class="f" style="font-size:12px">'+q.co+'</div><div class="d">'+q.ct+' | '+q.d+'</div></td><td class="c">'+_B(q.st)+'</td><td class="r d">'+q.q+'명 / '+q.bg+'</td></tr>'});
  h+='</tbody></table></div></div><div class="gp-r"><div class="gp-ph"><span>문의 상세</span></div><div class="gp-sb" style="padding:10px">';
  if(!G.is)h+='<div class="gp-em">좌측에서 문의를 선택하세요</div>';
  else{var q=IQ.find(function(x){return x.i===G.is});if(q){h+='<div class="gp-dg"><div class="gp-di"><i>고객사</i><b style="font-family:Noto Sans KR,sans-serif;font-size:13px">'+q.co+'</b></div><div class="gp-di"><i>상태</i><b>'+_B(q.st)+'</b></div><div class="gp-di"><i>접수일</i><b>'+q.d+'</b></div></div>';
  h+='<div class="gp-ds">문의 정보</div><div style="display:grid;grid-template-columns:80px 1fr;gap:4px 8px;font-size:11px"><span class="d">담당자</span><span class="f">'+q.ct+'</span><span class="d">연락처</span><span class="m" style="font-size:11px">'+q.ph+'</span><span class="d">예산</span><span class="f" style="color:#4a90d9">'+q.bg+'</span><span class="d">인원</span><span class="f">'+q.q+'명</span><span class="d">카테고리</span><span>'+(q.ca||'-')+'</span><span class="d">요청사항</span><span>'+(q.mm||'-')+'</span></div>';
  if(q.st==='PENDING')h+='<div style="display:flex;gap:6px;margin-top:12px;padding-top:10px;border-top:1px solid #e2e8f0"><button class="gp-btn p" onclick="alert(\'승인\')">승인 + 제안서 생성</button><button class="gp-btn dg" onclick="alert(\'반려\')">반려</button></div>';
  if(q.st==='APPROVED')h+='<div class="gp-ds">연결된 제안서</div><div style="padding:4px 0;font-size:11px"><span style="color:#4a90d9;cursor:pointer;text-decoration:underline">제안서 #'+q.i+' 바로가기</span></div>';}}
  h+='</div></div></div>';E('ai').innerHTML=h;
}

/* ═══ ADMIN: 전체 주문현황 ═══ */
function rAT(){
  var tO=OD.length,tS=0,tC=0;OD.forEach(function(o){var p=_P(o.p);tS+=p.p*o.q;tC+=p.s*o.q});
  var pipe=['DRAFT','COLLECTING','CLOSED','ORDERED','SHIPPING','COMPLETE'],pl={DRAFT:'초안',COLLECTING:'수집중',CLOSED:'마감',ORDERED:'발주',SHIPPING:'배송중',COMPLETE:'완료'},pb={DRAFT:'#f1f5f9',COLLECTING:'#eef4fb',CLOSED:'#fef9ee',ORDERED:'#dbeafe',SHIPPING:'#d1fae5',COMPLETE:'#ecfdf5'},pf={DRAFT:'#6b7280',COLLECTING:'#2563eb',CLOSED:'#d49a2a',ORDERED:'#3b82f6',SHIPPING:'#059669',COMPLETE:'#22c55e'},sc={};TP.forEach(function(t){sc[t.st]=(sc[t.st]||0)+1});
  var h='<div class="gp-pp">';pipe.forEach(function(s,i){if(i)h+='<i>→</i>';h+='<div style="background:'+pb[s]+';color:'+pf[s]+'">'+pl[s]+' '+(sc[s]||0)+'</div>'});h+='</div>';
  h+='<div class="gp-cds">';[{l:'캠페인',v:TP.length+'개'},{l:'주문',v:_N(tO)+'건'},{l:'매출',v:_S(tS),c:'#4a90d9'},{l:'매입',v:_S(tC),c:'#ea580c'},{l:'마진',v:_S(tS-tC),c:'#22c55e'}].forEach(function(x){h+='<div class="gp-cd"><i>'+x.l+'</i><b'+(x.c?' style="color:'+x.c+'"':'')+'>'+x.v+'</b></div>'});h+='</div>';
  h+='<div class="gp-sp"><div class="gp-l"><div class="gp-ph"><span>캠페인별</span></div><div class="gp-sb"><table><thead><tr><th>캠페인</th><th>고객사</th><th class="c">상태</th><th class="r">수신</th><th class="r">주문</th><th class="r">매출</th></tr></thead><tbody>';
  TP.forEach(function(t){var os=OD.filter(function(o){return o.t===t.i}),am=0;os.forEach(function(o){am+=_P(o.p).p*o.q});h+='<tr class="ck'+(G.ts===t.i?' s':'')+'" onclick="G.ts='+t.i+';rAT()"><td class="f">'+t.n+'</td><td>'+t.co+'</td><td class="c">'+_B(t.st)+'</td><td class="r">'+t.rc+'</td><td class="r">'+os.length+'</td><td class="r m" style="font-weight:600;color:#4a90d9">'+_N(am)+'</td></tr>'});
  h+='</tbody></table></div></div><div class="gp-r"><div class="gp-ph"><span>'+(G.ts?'캠페인 상세':'전체 집계')+'</span><div style="display:flex;gap:4px"><button class="gp-btn sm">발주서 일괄</button><button class="gp-btn sm">엑셀</button></div></div><div class="gp-sb" style="padding:10px">';
  if(!G.ts){
    var cA={};OD.forEach(function(o){var t=TP.find(function(x){return x.i===o.t});if(!t)return;cA[t.co]=(cA[t.co]||0)+_P(o.p).p*o.q});var cR=Object.keys(cA).map(function(k){return{n:k,a:cA[k]}}).sort(function(a,b){return b.a-a.a}),mx=cR.length?cR[0].a:1;
    h+='<div class="gp-ds">고객사별 주문금액</div>';cR.forEach(function(c){h+='<div style="display:flex;align-items:center;gap:6px;margin-bottom:3px"><span class="d" style="width:90px;text-align:right;flex-shrink:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+c.n+'</span><div style="flex:1;height:14px;background:#f0f4f9;border-radius:2px;overflow:hidden"><div style="width:'+(c.a/mx*100)+'%;height:100%;background:#4a90d9;border-radius:2px"></div></div><span class="d m" style="width:50px;text-align:right">'+_S(c.a)+'</span></div>'});
    var pA={};OD.forEach(function(o){var p=_P(o.p);pA[p.n]=(pA[p.n]||0)+o.q});var pR=Object.keys(pA).map(function(k){return{n:k,c:pA[k]}}).sort(function(a,b){return b.c-a.c}),pm=pR.length?pR[0].c:1;
    h+='<div class="gp-ds" style="margin-top:12px">상품별 주문량</div>';pR.forEach(function(p){h+='<div style="display:flex;align-items:center;gap:6px;margin-bottom:3px"><span class="d" style="width:100px;text-align:right;flex-shrink:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+p.n+'</span><div style="flex:1;height:14px;background:#f0f4f9;border-radius:2px;overflow:hidden"><div style="width:'+(p.c/pm*100)+'%;height:100%;background:#22c55e;border-radius:2px"></div></div><span class="d m" style="width:36px;text-align:right">'+p.c+'</span></div>'});
    h+='<div class="gp-ds" style="margin-top:12px">매입처별</div><table><thead><tr><th>매입처</th><th class="r">건수</th><th class="r">매입</th></tr></thead><tbody>';SU.forEach(function(s){var c=0,a=0;OD.forEach(function(o){if(s.p.indexOf(o.p)!==-1){c+=o.q;a+=_P(o.p).s*o.q}});if(c)h+='<tr><td class="f">'+s.n+'</td><td class="r">'+_N(c)+'</td><td class="r m" style="font-weight:600;color:#ea580c">'+_N(a)+'</td></tr>'});h+='</tbody></table>';
  }else{var t=TP.find(function(x){return x.i===G.ts}),os=OD.filter(function(o){return o.t===t.i}),sa=0,ca=0;os.forEach(function(o){sa+=_P(o.p).p*o.q;ca+=_P(o.p).s*o.q});
  h+='<div class="gp-dg"><div class="gp-di"><i>수신자</i><b>'+t.rc+'명</b></div><div class="gp-di"><i>주문</i><b>'+os.length+'건</b></div><div class="gp-di"><i>매출</i><b style="color:#4a90d9">'+_S(sa)+'</b></div></div>';
  h+='<table><thead><tr><th>수신자</th><th>받는이</th><th>상품</th><th class="r">금액</th><th class="c">상태</th><th>송장</th></tr></thead><tbody>';os.slice(0,40).forEach(function(o){var rv=RC.find(function(r){return r.x===o.r})||{nm:'?'},pd=_P(o.p);h+='<tr><td>'+rv.nm+'</td><td'+(o.rn!==rv.nm?' class="f" style="color:#4a90d9"':'')+'>'+o.rn+'</td><td>'+pd.n+'</td><td class="r m" style="font-weight:600;color:#4a90d9">'+_N(pd.p*o.q)+'</td><td class="c">'+_B(o.s)+'</td><td class="d m" style="font-size:9px">'+(o.tk||'-')+'</td></tr>'});if(os.length>40)h+='<tr><td colspan="6" class="d c">... 외 '+(os.length-40)+'건</td></tr>';h+='</tbody></table>';}
  h+='</div></div></div>';E('at').innerHTML=h;
}

/* ═══ CLIENT: 카탈로그/요청서 ═══ */
function rCC(){
  var mn=+(E('_cmi')?E('_cmi').value:20000)||0,mx=+(E('_cmx')?E('_cmx').value:60000)||999999,kw=(E('_ckw')?E('_ckw').value:'').toLowerCase();
  var cts=[];document.querySelectorAll('._ccc').forEach(function(c,i){if(c.checked)cts.push(CATS[i].n)});
  var fl=PR.filter(function(p){if(!p.a)return false;if(p.p<mn||p.p>mx)return false;if(cts.length&&cts.indexOf(p.ct)===-1)return false;if(kw&&p.n.toLowerCase().indexOf(kw)===-1)return false;return true});
  var h='<div class="gp-sp"><div class="gp-l" style="width:280px;min-width:240px"><div class="gp-ph"><span>카탈로그 필터</span></div><div class="gp-sb" style="padding:8px 10px">';
  h+='<div class="gp-fg"><label>예산 범위 (원)</label><div style="display:flex;gap:4px"><input class="gp-inp" type="number" id="_cmi" value="'+mn+'" style="flex:1"><span style="line-height:28px;color:#94a3b8">~</span><input class="gp-inp" type="number" id="_cmx" value="'+(mx===999999?60000:mx)+'" style="flex:1"></div></div>';
  h+='<div class="gp-fg"><label>카테고리</label>';CATS.forEach(function(c){h+='<label style="display:flex;align-items:center;gap:4px;font-size:11px;cursor:pointer;margin-top:2px"><input type="checkbox" checked class="_ccc"> '+c.n+'</label>'});h+='</div>';
  h+='<div class="gp-fg"><label>검색</label><input class="gp-inp" placeholder="상품명..." id="_ckw" oninput="rCC()" value="'+kw+'" style="width:100%"></div>';
  h+='<button class="gp-btn p" style="width:100%;margin-top:8px" onclick="rCC()">검색</button>';
  h+='<div class="gp-ds" style="margin-top:14px">문의/요청서</div><div class="gp-fg"><label>고객사명</label><input class="gp-inp" placeholder="고객사명" style="width:100%"></div><div class="gp-fg"><label>담당자</label><input class="gp-inp" placeholder="담당자명" style="width:100%"></div><div class="gp-fg"><label>연락처</label><input class="gp-inp" placeholder="010-0000-0000" style="width:100%"></div><div class="gp-fg"><label>인원</label><input class="gp-inp" type="number" placeholder="수량" style="width:100%"></div><div class="gp-fg"><label>요청사항</label><textarea class="gp-inp" style="width:100%;height:50px" placeholder="상세 요청"></textarea></div><button class="gp-btn" style="width:100%">요청서 제출</button>';
  h+='</div></div><div class="gp-r"><div class="gp-ph"><span>상품 카탈로그 ('+fl.length+')</span></div><div class="gp-sb" style="padding:8px 10px">';
  fl.forEach(function(p){h+='<div class="gp-pc"><div>IMG</div><div style="flex:1;min-width:0"><div style="font-size:11px;font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'+p.n+'</div><div style="font-size:11px;font-family:JetBrains Mono,monospace;color:#4a5568">'+_N(p.p)+'원</div><div style="font-size:9px;color:#94a3b8">'+p.ct+' | '+p.sp+'</div></div></div>'});
  if(!fl.length)h+='<div class="gp-em">조건에 맞는 상품이 없습니다</div>';
  h+='</div></div></div>';E('cc').innerHTML=h;
}

/* ═══ CLIENT: 제안서 생성 ═══ */
function rCP(){
  var q=(E('_ppq')?E('_ppq').value:'').toLowerCase(),ct=E('_ppc')?E('_ppc').value:'';
  var fl=PR.filter(function(p){if(!p.a)return false;if(q&&p.n.toLowerCase().indexOf(q)===-1)return false;if(ct&&p.ct!==ct)return false;return true});
  var sp=PR.filter(function(p){return G.pp[p.i]});
  var h='<div class="gp-sp"><div class="gp-l" style="width:320px;min-width:260px"><div class="gp-ph"><span>상품 선택</span></div><div class="gp-fb" style="padding:4px 8px"><input class="gp-inp" placeholder="검색..." id="_ppq" oninput="rCP()" value="'+q+'" style="flex:1"><select class="gp-sel" id="_ppc" onchange="rCP()"><option value="">전체</option>';
  CATS.forEach(function(c){h+='<option'+(ct===c.n?' selected':'')+'>'+c.n+'</option>'});
  h+='</select></div><div class="gp-sb" style="padding:6px 8px">';
  fl.forEach(function(p){var sel=G.pp[p.i];h+='<div class="gp-pc'+(sel?' s':'')+'" onclick="G.pp['+p.i+']=!G.pp['+p.i+'];rCP()"><div>IMG</div><div style="flex:1;min-width:0"><div style="font-size:11px;font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'+p.n+'</div><div style="font-size:11px;font-family:JetBrains Mono,monospace;color:#4a5568">'+_N(p.p)+'원</div><div style="font-size:9px;color:#94a3b8">'+p.ct+'</div></div><input type="checkbox"'+(sel?' checked':'')+' style="pointer-events:none;flex-shrink:0"></div>'});
  h+='</div><div class="gp-ft"><span>선택: <strong class="m">'+sp.length+'</strong>개</span></div></div>';
  h+='<div class="gp-r"><div class="gp-ph"><span>제안서 미리보기</span><div style="display:flex;gap:4px"><button class="gp-btn sm p">PDF 다운로드</button><button class="gp-btn sm">견적서 생성</button></div></div><div class="gp-sb" style="padding:10px">';
  if(!sp.length)h+='<div class="gp-em">좌측에서 상품을 선택하면 제안서가 생성됩니다</div>';
  else{h+='<div style="border:1px solid #e2e8f0;border-radius:4px;padding:12px;background:#fafcff"><div style="font-size:14px;font-weight:800;margin-bottom:4px">단체 선물 제안서</div><div class="d" style="margin-bottom:10px">Vendys 단체선물대장 | '+sp.length+'종</div><table><thead><tr><th>#</th><th>상품명</th><th>카테고리</th><th class="r">단가(원)</th></tr></thead><tbody>';
  sp.forEach(function(p,i){h+='<tr><td>'+(i+1)+'</td><td class="f">'+p.n+'</td><td class="d">'+p.ct+'</td><td class="r m" style="font-weight:600;color:#4a90d9">'+_N(p.p)+'</td></tr>'});
  h+='</tbody></table><div style="margin-top:8px;padding-top:6px;border-top:1px solid #e2e8f0;font-size:11px">가격 범위: <strong class="m" style="color:#4a90d9">'+_N(Math.min.apply(null,sp.map(function(p){return p.p})))+' ~ '+_N(Math.max.apply(null,sp.map(function(p){return p.p})))+'</strong>원</div></div>';
  h+='<div class="gp-ds" style="margin-top:12px">견적 시뮬레이션</div><div style="display:flex;gap:6px;align-items:center;margin-bottom:6px"><span class="d">인원:</span><input class="gp-inp" type="number" value="'+(E('_ppn')?E('_ppn').value:'100')+'" id="_ppn" oninput="rCP()" style="width:80px"><span class="d">명</span></div>';
  var ppl=+(E('_ppn')?E('_ppn').value:100)||100,gt=0;h+='<table><thead><tr><th>상품명</th><th class="r">단가</th><th class="r">수량</th><th class="r">소계</th></tr></thead><tbody>';sp.forEach(function(p){var sub=p.p*ppl;gt+=sub;h+='<tr><td>'+p.n+'</td><td class="r m">'+_N(p.p)+'</td><td class="r m">'+_N(ppl)+'</td><td class="r m f" style="color:#4a90d9">'+_N(sub)+'</td></tr>'});h+='<tr style="border-top:2px solid #e2e8f0"><td class="f" colspan="3">합계</td><td class="r m f" style="font-size:13px;color:#4a90d9">'+_N(gt)+'</td></tr></tbody></table>';}
  h+='</div></div></div>';E('cp').innerHTML=h;
}

/* ═══ CLIENT: 견적/사용자등록/선택 ═══ */
function rCO(){
  var t=TP.find(function(t){return t.st==='COLLECTING'})||TP[0];
  var rs=RC.filter(function(r){return r.t===t.i}),os=OD.filter(function(o){return o.t===t.i}),rate=rs.length?(os.length/rs.length*100):0;
  var h='<div class="gp-sp"><div class="gp-l" style="width:300px;min-width:240px"><div class="gp-ph"><span>'+t.n+' | '+t.co+'</span></div><div class="gp-sb" style="padding:8px 10px">';
  h+='<div class="d" style="margin-bottom:6px">마감: '+t.sh+'</div>';
  h+='<div class="gp-ds">요약</div><div class="gp-dg" style="grid-template-columns:1fr 1fr"><div class="gp-di"><i>수신자</i><b>'+rs.length+'명</b></div><div class="gp-di"><i>주문</i><b>'+os.length+'건</b></div></div>';
  h+='<div class="gp-pr" style="margin:4px 0"><div style="width:'+rate+'%;background:#4a90d9"></div></div><div class="d" style="margin-bottom:8px">응답률 '+rate.toFixed(1)+'%</div>';
  h+='<div class="gp-ds">확정 상품</div>';t.pr.forEach(function(pi,i){var pd=_P(pi);h+='<div style="display:flex;align-items:center;gap:6px;padding:3px 0;border-bottom:1px solid #f1f5f9"><span class="d" style="width:14px">'+(i+1)+'</span><span style="flex:1;font-size:11px">'+pd.n+'</span><span class="m" style="font-size:11px">'+_N(pd.p)+'</span></div>'});
  h+='<div style="display:flex;gap:4px;margin-top:10px"><button class="gp-btn p" style="flex:1">알림톡 발송</button><button class="gp-btn" style="flex:1">리마인드</button></div></div></div>';
  h+='<div class="gp-r"><div class="gp-st"><div class="'+(G.cs==='recv'?'a':'')+'" onclick="G.cs=\'recv\';rCO()">사용자 등록</div><div class="'+(G.cs==='sel'?'a':'')+'" onclick="G.cs=\'sel\';rCO()">상품 선택/주문</div><div class="'+(G.cs==='stat'?'a':'')+'" onclick="G.cs=\'stat\';rCO()">주문 현황</div></div><div class="gp-sb" style="padding:8px 10px">';
  if(G.cs==='recv'){
    h+='<div class="gp-fm"><div style="display:flex;gap:6px;margin-bottom:4px"><div class="gp-fg" style="flex:1;margin:0"><label>이름</label><input class="gp-inp" placeholder="홍길동" style="width:100%"></div><div class="gp-fg" style="flex:1;margin:0"><label>연락처</label><input class="gp-inp" placeholder="010-0000-0000" style="width:100%"></div><div class="gp-fg" style="flex:1.5;margin:0"><label>주소</label><input class="gp-inp" placeholder="도로명 주소" style="width:100%"></div></div><div style="text-align:right"><button class="gp-btn sm p">+ 추가</button><button class="gp-btn sm" style="margin-left:4px">엑셀 붙여넣기</button></div></div>';
    h+='<table><thead><tr><th>이름</th><th>연락처</th><th>주소</th><th>방식</th><th class="c">주문</th></tr></thead><tbody>';
    rs.slice(0,30).forEach(function(r){var has=os.find(function(o){return o.r===r.x});h+='<tr><td class="f">'+r.nm+'</td><td class="m d" style="font-size:10px">'+r.ph+'</td><td class="d" style="max-width:140px;overflow:hidden;text-overflow:ellipsis">'+r.ad+'</td><td class="d">'+r.tp+'</td><td class="c">'+(has?'<span style="color:#22c55e;font-weight:700">Y</span>':'<span style="color:#e85d5d;font-weight:700">N</span>')+'</td></tr>'});
    if(rs.length>30)h+='<tr><td colspan="5" class="d c">... 외 '+(rs.length-30)+'명</td></tr>';h+='</tbody></table>';
  }else if(G.cs==='sel'){
    h+='<div class="d" style="margin-bottom:6px;font-weight:600">수신자별 상품 선택 (알림톡으로 수신자가 직접 선택 가능)</div>';
    h+='<table><thead><tr><th>수신자</th><th>상품</th><th class="c">수량</th><th>받는이</th><th class="c">상태</th></tr></thead><tbody>';
    rs.slice(0,30).forEach(function(r){var ord=os.find(function(o){return o.r===r.x});h+='<tr><td class="f">'+r.nm+'</td>';
    if(ord){var pd=_P(ord.p);h+='<td>'+pd.n+'</td><td class="c">'+ord.q+'</td><td'+(ord.rn!==r.nm?' class="f" style="color:#4a90d9"':'')+'>'+ord.rn+'</td><td class="c">'+_B(ord.s)+'</td>';}
    else{h+='<td><select class="gp-sel" style="width:120px">';t.pr.forEach(function(pi){h+='<option>'+_P(pi).n+'</option>'});h+='</select></td><td class="c"><input type="number" value="1" style="width:36px;text-align:center;border:1px solid #cbd5e1;border-radius:3px;font-size:11px"></td><td><input class="gp-inp" placeholder="수신자동일" style="width:80px"></td><td class="c d">미주문</td>';}h+='</tr>'});
    if(rs.length>30)h+='<tr><td colspan="5" class="d c">... 외 '+(rs.length-30)+'명</td></tr>';h+='</tbody></table><div style="text-align:right;margin-top:6px"><button class="gp-btn p">일괄 저장</button></div>';
  }else{
    var shC=os.filter(function(o){return o.s==='SHIPPING'}).length,dlC=os.filter(function(o){return o.s==='DELIVERED'}).length;
    h+='<div class="gp-dg"><div class="gp-di"><i>전체</i><b>'+os.length+'건</b></div><div class="gp-di"><i>배송중</i><b style="color:#d49a2a">'+shC+'</b></div><div class="gp-di"><i>배송완료</i><b style="color:#22c55e">'+dlC+'</b></div></div>';
    h+='<table><thead><tr><th>수신자</th><th>받는이</th><th>상품</th><th class="r">금액</th><th class="c">상태</th><th>송장</th></tr></thead><tbody>';
    os.forEach(function(o){var rv=RC.find(function(r){return r.x===o.r})||{nm:'?'},pd=_P(o.p);h+='<tr><td>'+rv.nm+'</td><td'+(o.rn!==rv.nm?' class="f" style="color:#4a90d9"':'')+'>'+o.rn+'</td><td>'+pd.n+'</td><td class="r m" style="font-weight:600;color:#4a90d9">'+_N(pd.p*o.q)+'</td><td class="c">'+_B(o.s)+'</td><td class="d m" style="font-size:9px">'+(o.tk||'-')+'</td></tr>'});
    h+='</tbody></table><div style="text-align:right;margin-top:6px"><button class="gp-btn sm p">견적서 다운로드</button></div>';}
  h+='</div></div></div>';E('co').innerHTML=h;
}

/* ═══ SUPPLIER: 상품별 주문현황 ═══ */
function rSO(){
  var su=SU.find(function(s){return s.id===G.si})||SU[0],mo=OD.filter(function(o){return su.p.indexOf(o.p)!==-1});
  var nc=mo.filter(function(o){return o.s==='ORDERED'}).length,sc=mo.filter(function(o){return o.s==='SHIPPING'}).length,dc=mo.filter(function(o){return o.s==='DELIVERED'}).length,ta=0;mo.forEach(function(o){ta+=_P(o.p).s*o.q});
  var h='<div class="gp-fb"><span class="f" style="font-size:12px">매입처:</span><select class="gp-sel" onchange="G.si=this.value;rSO()">';SU.forEach(function(s){h+='<option value="'+s.id+'"'+(s.id===su.id?' selected':'')+'>'+s.n+'</option>'});h+='</select></div>';
  h+='<div class="gp-cds">';[{l:'신규주문',v:nc+'건',c:'#e85d5d'},{l:'배송중',v:sc+'건',c:'#d49a2a'},{l:'배송완료',v:dc+'건',c:'#22c55e'},{l:'발주금액',v:_S(ta),c:'#ea580c'}].forEach(function(x){h+='<div class="gp-cd"><i>'+x.l+'</i><b style="color:'+x.c+'">'+x.v+'</b></div>'});h+='</div>';
  var pm={};mo.forEach(function(o){if(!pm[o.p])pm[o.p]={pd:_P(o.p),t:0,or:0,sh:0,dl:0,a:0};pm[o.p].t+=o.q;if(o.s==='ORDERED')pm[o.p].or+=o.q;if(o.s==='SHIPPING')pm[o.p].sh+=o.q;if(o.s==='DELIVERED')pm[o.p].dl+=o.q;pm[o.p].a+=_P(o.p).s*o.q});
  h+='<div style="flex:1;overflow:auto;margin:0 16px 10px;border:1px solid #e2e8f0;border-radius:4px"><table><thead><tr><th>코드</th><th>상품명</th><th class="r">전체</th><th class="r">신규</th><th class="r">배송중</th><th class="r">완료</th><th class="r">매입금액</th><th style="min-width:70px">진행</th></tr></thead><tbody>';
  Object.values(pm).forEach(function(g){var rate=g.t?((g.sh+g.dl)/g.t*100):0;h+='<tr><td class="m d" style="font-size:9px">'+g.pd.c+'</td><td class="f">'+g.pd.n+'</td><td class="r f">'+_N(g.t)+'</td><td class="r" style="color:#e85d5d;font-weight:700">'+(g.or||'-')+'</td><td class="r" style="color:#d49a2a;font-weight:600">'+(g.sh||'-')+'</td><td class="r" style="color:#22c55e;font-weight:600">'+(g.dl||'-')+'</td><td class="r m" style="font-weight:600;color:#ea580c">'+_N(g.a)+'</td><td><div class="gp-pr" style="height:5px"><div style="width:'+rate+'%;background:#22c55e"></div></div><span class="d m" style="font-size:9px">'+rate.toFixed(0)+'%</span></td></tr>'});
  h+='</tbody></table></div><div class="gp-ft"><span>'+Object.keys(pm).length+'개 상품 / '+mo.length+'건</span><button class="gp-btn sm">발주서 다운로드</button></div>';
  E('so').innerHTML=h;
}

/* ═══ SUPPLIER: 주문정보/송장입력 ═══ */
function rST(){
  var su=SU.find(function(s){return s.id===G.si})||SU[0],mo=OD.filter(function(o){return su.p.indexOf(o.p)!==-1});
  var f=E('_sf')?E('_sf').value:'',q=(E('_sq')?E('_sq').value:'').toLowerCase();
  var fl=mo.filter(function(o){if(f&&o.s!==f)return false;if(q){var pd=_P(o.p);if((o.rn+' '+pd.n).toLowerCase().indexOf(q)===-1)return false}return true});
  var h='<div class="gp-fb"><span class="f" style="font-size:12px">'+su.n+'</span><select class="gp-sel" id="_sf" onchange="rST()"><option value="">전체</option><option value="ORDERED"'+(f==='ORDERED'?' selected':'')+'>신규주문</option><option value="SHIPPING"'+(f==='SHIPPING'?' selected':'')+'>배송중</option><option value="DELIVERED"'+(f==='DELIVERED'?' selected':'')+'>배송완료</option></select><input class="gp-inp" placeholder="받는이, 상품..." id="_sq" oninput="rST()" value="'+q+'" style="flex:1;max-width:200px"><div style="margin-left:auto;display:flex;gap:4px"><button class="gp-btn sm p">발주서</button><button class="gp-btn sm">엑셀</button></div></div>';
  h+='<div style="flex:1;overflow:auto;margin:0 16px;border:1px solid #e2e8f0;border-radius:4px"><table><thead><tr><th style="width:24px"><input type="checkbox" onchange="document.querySelectorAll(\'._sck\').forEach(function(c){c.checked=this.checked}.bind(this))"></th><th>캠페인</th><th>상품</th><th>받는이</th><th>주소</th><th>출고</th><th class="c">상태</th><th>송장</th></tr></thead><tbody>';
  fl.forEach(function(o){var rv=RC.find(function(r){return r.x===o.r})||{nm:'?',ad:''},tp=TP.find(function(t){return t.i===o.t})||{n:'?',co:'?',sh:'-'},pd=_P(o.p);
  h+='<tr'+(o.s==='ORDERED'?' class="gp-w"':'')+'>><td><input type="checkbox" class="_sck"></td><td class="d" style="font-size:10px">'+tp.co+'<br>'+tp.n+'</td><td class="f">'+pd.n+'</td><td class="f">'+o.rn+'</td><td class="d" style="max-width:120px;overflow:hidden;text-overflow:ellipsis">'+rv.ad+'</td><td class="m" style="font-size:10px;color:#e85d5d;font-weight:700">'+tp.sh+'</td><td class="c">'+_B(o.s)+'</td><td style="font-size:10px">'+(o.tk?'<span class="d m" style="font-size:9px">'+o.tk+'</span>':'<input class="gp-inp" placeholder="송장번호" style="width:120px;font-size:10px">')+'</td></tr>'});
  if(!fl.length)h+='<tr><td colspan="8" class="gp-em">데이터가 없습니다</td></tr>';
  h+='</tbody></table></div>';
  h+='<div class="gp-tk"><div style="font-size:11px;font-weight:700;color:#4a5568;margin-bottom:4px">일괄 송장 입력</div><div style="display:flex;gap:6px;align-items:center;flex-wrap:wrap"><select class="gp-sel"><option>CJ대한통운</option><option>한진택배</option><option>롯데택배</option><option>우체국택배</option></select><input class="gp-inp" placeholder="송장번호" style="width:180px"><button class="gp-btn sm p">선택 항목 일괄 적용</button><button class="gp-btn sm">엑셀 송장 업로드</button></div></div>';
  h+='<div class="gp-ft"><span>'+fl.length+'건 (전체 '+mo.length+'건)</span></div>';
  E('st').innerHTML=h;
}

_R();
</script>
